

设备

    linux-0.11将设备分为两类，字符设备和块设备。
    字符设备是只能顺序读取或写入的设备。
    块设备以数据块为操作单位的设备。

    

    下面主要以硬盘为例介绍基于中断的设备驱动程序。

    硬盘是一个块设备，以块位单位对数据进行读取和写入操作。

    内核为每个设备维护一个请求队列，记录该设备需要完成的请求。

    当内核产生一个设备请求时，如果设备请求队列为空，说明设备当前没有请求，就直接处理请求，否则就将请求插入到请求队列中。

    当设备完成一个请求时，就会想处理器发送一个中断，处理器会执行相应的中断处理程序。
    中断处理程序首先释放已完成的请求，并唤醒阻塞在该请求上的进程，如果请求队列中还有项，就会继续执行请求，然后退出中断。
    然后新的请求完成时又会产生新的中断，直到请求队列中没有未完成的请求，则处理结束。


    
    
